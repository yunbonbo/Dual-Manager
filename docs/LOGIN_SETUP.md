# ログイン機能 セットアップ手順

ダッシュボードにアクセスするには、Supabase で認証を有効化し、管理者アカウントを作成する必要があります。

---

## ステップ1: Supabase で Email 認証を有効化

1. [Supabase ダッシュボード](https://supabase.com/dashboard) にログイン
2. プロジェクト **Dual-Manager** を選択
3. 左メニューから **Authentication** → **Providers** をクリック
4. **Email** の行を探し、右側のトグルを **ON**（有効）にする
5. そのままの設定で問題ありません（「Confirm email」はオフのままでOK）

---

## ステップ2: 管理者ユーザーを作成

1. 左メニュー **Authentication** → **Users** をクリック
2. 右上の **Add user** → **Create new user** を選択
3. 以下を入力：
   - **Email**: 管理者用のメールアドレス（例: `admin@example.com`）
   - **Password**: 8文字以上のパスワード
4. **Create user** をクリック

> 作成したメールアドレスとパスワードは、ログイン画面で使用します。忘れないようにメモしてください。

---

## ステップ3: アプリでログインを確認

1. 開発サーバーを起動（未起動の場合）:
   ```bash
   npm run dev
   ```

2. ブラウザで `http://localhost:3001`（または `http://localhost:3000`）を開く

3. 予約フォームの右上 **「管理者」** をクリック

4. ログイン画面が表示されたら、ステップ2で作成したメールアドレスとパスワードを入力

5. **ログイン** をクリック

6. ダッシュボードに遷移すれば成功です

---

## トラブルシューティング

### 「メールアドレスまたはパスワードが正しくありません」と表示される

- Supabase の **Authentication** → **Users** で、該当ユーザーが作成されているか確認
- メールアドレス・パスワードの入力ミスがないか確認
- パスワードは8文字以上である必要があります

### ログイン後すぐにログイン画面に戻る

- ブラウザの開発者ツール（F12）→ **Console** タブでエラーを確認
- `.env` の `NUXT_PUBLIC_SUPABASE_URL` と `NUXT_PUBLIC_SUPABASE_ANON_KEY` が、使用中の Supabase プロジェクトと一致しているか確認

### ダッシュボードに直接アクセスするとログイン画面にリダイレクトされる

- これは正常な動作です。未ログインの場合は `/login` に誘導されます
- ログイン後は `/dashboard` にアクセスできます

---

## 補足: ログイン状態の記憶

- ログインすると、セッションはブラウザの **localStorage** に保存されます
- ブラウザを閉じても、次回アクセス時は自動でログイン状態が維持されます
- **ログアウト** ボタンを押すと、ログイン状態が解除されます
